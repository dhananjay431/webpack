(()=>{var t,n=function(){function t(t){this.n="",this.n=t}return t.prototype.text=function(){switch(typeof this.n){case"number":case"string":this.n=this.n.toString();break;case"object":this.n=JSON.stringify(this.n);break;case"undefined":this.n="undefined"}return this},t.prototype.number=function(){return Number.isNaN(Number(this.n))?this.n=0:this.n=Number(this.n),this},t.prototype.int=function(){return this.number(),this.n=parseInt(this.n),this},t.prototype.float=function(){return this.number(),this.n=parseFloat(this.n),this},t.prototype.fix=function(t){return this.number(),this.n=this.n.toFixed(t),this},t.prototype.otoa=function(){return Array.isArray(this.ref().val())?this.n=this.n:this.n=[this.n],this},t.prototype._tuple=function(t,n,r){return t.map((function(t){var i,e,o,s={new:(i={},i[r]={},i),old:(e={},e[r]={},e)};return s.new[r]=t,null!=t[n]&&""!=t[n]?s.old[r]=((o={})[n]=t[n],o):delete s.old,1==t.del&&delete s.new,s}))},t.prototype.tuple=function(t,n){return this.n=this._tuple(this.otoa().ref().val(),t,n),this},t.prototype._blank=function(t){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=r[n],e=i[0],o=i[1];"object"==typeof o?this._blank(o):t[e]=""}return t},t.prototype.blank=function(){return this.n=this._blank(this.ref().val()),this},t.prototype.ref=function(){return this.n=JSON.parse(JSON.stringify(this.n)),this},t.prototype.mapAdd=function(t){return this.n=this.otoa().ref().val().map((function(n){for(var r in t)n[r]=t[r];return n})),this},t.prototype.mapDel=function(t){return this.n=this.otoa().ref().val().map((function(n){for(var r=0,i=t;r<i.length;r++)delete n[i[r]];return n})),this},t.prototype.mapChange=function(t){return this.n=this.otoa().ref().val().map((function(n){for(var r in t)n[r]&&(n[t[r]]=n[r]),delete n[r];return n})),this},t.prototype.filter=function(t){var n=this;return this.n=this.otoa().ref().val().filter((function(r){var i=0;for(var e in t)n._at(r,e)==t[e]&&i++;if(i==Object.keys(t).length)return r})),this},t.prototype._at=function(t,n){for(var r=(n=(n=n.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0,e=r.length;i<e;++i){var o=r[i];if(!(o in t))return;t=t[o]}return t},t.prototype.alert=function(){window.alert=function(t){console.log(t)}},t.prototype.console=function(){window.console.log=function(t){}},t.prototype.at=function(t){try{this.n=this._at(this.n,t)}catch(t){this.n=void 0}return this},t.prototype._it=function(t,n,r,i){var e=this;0==t?r(n):Promise.resolve(t.shift()).then((function(o){n.push(o),e._it(t,n,r,i)}),(function(t){i(t)}))},t.prototype.async=function(){var t=this;return new Promise((function(n,r){t.n=Array.isArray(t.n)?t.n:[t.n],t._it(t.n,[],n,r)}))},t.prototype.val=function(){return this.n},t}();(t=window).$=t.$||{},t.$.db=function(t){return new n(t)}})();