(()=>{"use strict";var t,n=function(){function t(t){this.n=t}return t.prototype.min=function(t,n){return void 0===n&&(n=0),this.n>=t?this.n=this.n:this.n=n,this},t.prototype.max=function(t,n){return void 0===n&&(n=0),this.n<=t?this.n=this.n:this.n=n,this},t.prototype.minMax=function(t,n,i){return void 0===i&&(i=0),this.n<=n&&this.n>=t?this.n=this.n:this.n=i,this},t.prototype.number=function(){return Number.isNaN(Number(this.n))?this.n=0:this.n=Number(this.n),this},t.prototype.int=function(){return this.number(),this.n=parseInt(this.n),this},t.prototype.float=function(){return this.number(),this.n=parseFloat(this.n),this},t.prototype.fix=function(t){return this.number(),this.n=this.n.toFixed(t),this},t.prototype.val=function(){return this.n},t}(),i=function(){function t(t){this.n=t}return t.prototype.ref=function(){return this.n=JSON.parse(JSON.stringify(this.n)),this},t.prototype.text=function(){switch(typeof this.n){case"number":case"string":this.n=this.n.toString();break;case"object":this.n=JSON.stringify(this.n);break;case"undefined":this.n="undefined"}return this},t.prototype.alert=function(){return window.alert=function(t){console.log(t)},this},t.prototype.console=function(){return window.console.log=function(t){},this},t.prototype._async=function(t,n,i,e){var r=this;0==t?i(n):Promise.resolve(t.shift()).then((function(o){n.push(o),r._async(t,n,i,e)}),(function(t){e(t)}))},t.prototype.async=function(){var t=this;return new Promise((function(n,i){t.n=Array.isArray(t.n)?t.n:[t.n],t._async(t.n,[],n,i)}))},t.prototype.val=function(){return this.n},t}(),e=function(){function t(t){this.n=t}return t.prototype.otoa=function(){return Array.isArray(new i(this.n).ref().val())?this.n=this.n:this.n=[this.n],this},t.prototype._tuple=function(t,n,i){return t.map((function(t){var e,r,o,s={new:(e={},e[i]={},e),old:(r={},r[i]={},r)};return s.new[i]=t,null!=t[n]&&""!=t[n]?s.old[i]=((o={})[n]=t[n],o):delete s.old,1==t.del&&delete s.new,s}))},t.prototype.tuple=function(t,n){return this.n=new i(this.n).ref().val(),this.n=this._tuple(this.otoa().val(),t,n),this},t.prototype._blank=function(t){for(var n=0,i=Object.entries(t);n<i.length;n++){var e=i[n],r=e[0],o=e[1];"object"==typeof o?this._blank(o):t[r]=""}return t},t.prototype.blank=function(){return this.n=this._blank(new i(this.n).ref()),this},t.prototype.mapAdd=function(t){return this.n=new i(this.n).ref().val(),this.n=this.otoa().val().map((function(n){for(var i in t)n[i]=t[i];return n})),this},t.prototype.mapDel=function(t){return this.n=new i(this.n).ref().val(),this.n=this.otoa().val().map((function(n){for(var i=0,e=t;i<e.length;i++)delete n[e[i]];return n})),this},t.prototype.mapChange=function(t){return this.n=new i(this.n).ref().val(),this.n=this.otoa().val().map((function(n){for(var i in t)n[i]&&(n[t[i]]=n[i]),delete n[i];return n})),this},t.prototype.filter=function(t){var n=this;return this.n=new i(this.n).ref().val(),this.n=this.otoa().val().filter((function(i){var e=0;for(var r in t)n._at(i,r)==t[r]&&e++;if(e==Object.keys(t).length)return i})),this},t.prototype._at=function(t,n){for(var i=(n=(n=n.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),e=0,r=i.length;e<r;++e){var o=i[e];if(!(o in t))return;t=t[o]}return t},t.prototype.at=function(t){try{this.n=this._at(this.n,t)}catch(t){this.n=void 0}return this},t.prototype.val=function(){return this.n},t}(),r=function(){function t(t){this.n="",this.n=t}return t.prototype.min=function(t,i){return void 0===i&&(i=0),this.n=new n(this.n).min(t,i).val(),this},t.prototype.max=function(t,i){return void 0===i&&(i=0),this.n=new n(this.n).max(t,i).val(),this},t.prototype.minMax=function(t,i,e){return void 0===e&&(e=0),this.n=new n(this.n).minMax(t,i,e).val(),this},t.prototype.number=function(){return this.n=new n(this.n).number().val(),this},t.prototype.int=function(){return this.n=new n(this.n).int().val(),this},t.prototype.float=function(){return this.n=new n(this.n).float().val(),this},t.prototype.fix=function(t){return this.n=new n(this.n).fix(t).val(),this},t.prototype.ref=function(){return this.n=new i(this.n).ref().val(),this},t.prototype.text=function(){return this.n=new i(this.n).text().val(),this},t.prototype.alert=function(){return this.n=new i("done").alert().val(),this},t.prototype.console=function(){return this.n=new i("done").console().val(),this},t.prototype.async=function(){return this.n=new i(this.n).async(),this},t.prototype.val=function(){return this.n},t.prototype.otoa=function(){return this.n=new e(this.n).otoa().val(),this},t.prototype.tuple=function(t,n){return this.n=new e(this.n).tuple(t,n).val(),this},t.prototype.blank=function(){return this.n=new e(this.n).blank().val(),this},t.prototype.mapAdd=function(t){return this.n=new e(this.n).mapAdd(t).val(),this},t.prototype.mapDel=function(t){return this.n=new e(this.n).mapDel(t).val(),this},t.prototype.mapChange=function(t){return this.n=new e(this.n).mapChange(t).val(),this},t.prototype.filter=function(t){return this.n=new e(this.n).mapChange(t).val(),this},t.prototype.at=function(t){return this.n=new e(this.n).at(t).val(),this},t}();(t=window).$=t.$||{},t.$.db=function(t){return new r(t)}})();